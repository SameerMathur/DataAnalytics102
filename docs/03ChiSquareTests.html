<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Analytics 102 -- Applied Statistics and Regression Using R – chisquaretests</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Data Analytics 102 – Applied Statistics and Regression Using R</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://www.qatar.cmu.edu/directory/sameer-mathur/" rel="" target="_blank"><i class="bi bi-globe" role="img">
</i> 
 <span class="menu-text">Sameer Mathur</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://docs.google.com/document/d/15Li_DpXPSA6NXyXyCzM3vUu766RBq87W/edit?usp=sharing&amp;ouid=100224206438187222136&amp;rtpof=true&amp;sd=true" rel="" target="_blank"><i class="bi bi-globe" role="img">
</i> 
 <span class="menu-text">Aryeman Gupta Mathur</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/SameerMathur/DataAnalytics102" rel="" target="_blank"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text">Book’s Github</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03ChiSquareTests.html">Chi-Square Tests</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/openscapes_hex.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01GettingStarted.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02ZTests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Z Tests</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03ChiSquareTests.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Chi-Square Tests</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04TTest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">t-tests</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANOVA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06Correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlation Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07LinearRegression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression.</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08Interaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09LogLinear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Log-Linear Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10LogLog.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Log-Log Regression</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<p><img src="BookCover102.png" class="img-fluid"></p>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#chi-square-tests" id="toc-chi-square-tests" class="nav-link active" data-scroll-target="#chi-square-tests">Chi-Square Tests</a>
  <ul class="collapse">
  <li><a href="#types-of-tests" id="toc-types-of-tests" class="nav-link" data-scroll-target="#types-of-tests">Types of Tests</a></li>
  <li><a href="#chi-square-goodness-of-fit-test" id="toc-chi-square-goodness-of-fit-test" class="nav-link" data-scroll-target="#chi-square-goodness-of-fit-test">Chi-Square Goodness of Fit test</a>
  <ul class="collapse">
  <li><a href="#a-business-application-of-the-chi-square-goodness-of-fit-test" id="toc-a-business-application-of-the-chi-square-goodness-of-fit-test" class="nav-link" data-scroll-target="#a-business-application-of-the-chi-square-goodness-of-fit-test">A Business Application of the Chi-Square Goodness of Fit test</a></li>
  <li><a href="#concept" id="toc-concept" class="nav-link" data-scroll-target="#concept">Concept</a></li>
  <li><a href="#numerical-illustration" id="toc-numerical-illustration" class="nav-link" data-scroll-target="#numerical-illustration">Numerical Illustration</a></li>
  <li><a href="#running-the-chi-square-goodness-of-fit-test-in-r" id="toc-running-the-chi-square-goodness-of-fit-test-in-r" class="nav-link" data-scroll-target="#running-the-chi-square-goodness-of-fit-test-in-r">Running the Chi-Square Goodness of Fit Test in R</a></li>
  <li><a href="#comparison-of-chi-square-goodness-of-fit-test-with-z-test-for-proportions" id="toc-comparison-of-chi-square-goodness-of-fit-test-with-z-test-for-proportions" class="nav-link" data-scroll-target="#comparison-of-chi-square-goodness-of-fit-test-with-z-test-for-proportions">Comparison of Chi-Square Goodness of Fit test with Z-test for Proportions</a></li>
  </ul></li>
  <li><a href="#chi-square-test-of-independence" id="toc-chi-square-test-of-independence" class="nav-link" data-scroll-target="#chi-square-test-of-independence">Chi-Square Test of Independence</a>
  <ul class="collapse">
  <li><a href="#a-business-application-of-the-chi-square-test-of-independence" id="toc-a-business-application-of-the-chi-square-test-of-independence" class="nav-link" data-scroll-target="#a-business-application-of-the-chi-square-test-of-independence">A Business Application of the Chi-Square Test of Independence</a></li>
  <li><a href="#chi-square-test-of-independence-technicalities" id="toc-chi-square-test-of-independence-technicalities" class="nav-link" data-scroll-target="#chi-square-test-of-independence-technicalities">Chi-Square Test of Independence – Technicalities</a></li>
  <li><a href="#running-the-chi-square-test-of-independence-test-in-r" id="toc-running-the-chi-square-test-of-independence-test-in-r" class="nav-link" data-scroll-target="#running-the-chi-square-test-of-independence-test-in-r">Running the Chi-Square Test of Independence Test in R</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="03ChiSquareTests.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="chi-square-tests" class="level1">
<h1>Chi-Square Tests</h1>
<p><em>January 22, 2024.</em></p>
<ol type="1">
<li>The chi-square test is a statistical test used to determine if there is a significant difference between the <strong>observed values</strong> and the <strong>expected values</strong> in a categorical data set.</li>
<li>It measures the <strong>deviation</strong> between the expected and observed frequencies in one or more categories and assesses whether this deviation is statistically significant.</li>
<li>The result of a chi-square test is a test statistic, and its p-value is compared against a threshold (e.g.&nbsp;<span class="math inline">\(\alpha = 0.05\)</span>) to determine the statistical significance of the observed differences.</li>
<li>The test is commonly used in <strong>hypothesis testing</strong>, contingency table analysis, and <strong>goodness-of-fit</strong> testing.</li>
</ol>
<section id="types-of-tests" class="level2">
<h2 class="anchored" data-anchor-id="types-of-tests">Types of Tests</h2>
<ol type="1">
<li>There are several types of chi-square tests. The most popular tests are as follows.</li>
</ol>
<table class="table">
<colgroup>
<col style="width: 31%">
<col style="width: 68%">
</colgroup>
<thead>
<tr class="header">
<th>Test</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>A. Goodness-of-fit test</strong></td>
<td>determine if a sample of data <strong>fits a specified distribution</strong></td>
</tr>
<tr class="even">
<td><strong>B. Independence test</strong></td>
<td>determine if there is a <strong>relationship between two categorical variables</strong></td>
</tr>
</tbody>
</table>
<ol start="2" type="1">
<li>Additional chi-square tests include:</li>
</ol>
<ul>
<li>Homogeneity test: used to determine if different populations have the same distribution of a categorical variable.</li>
<li>Contingency table test: used to analyze the relationship between two or more categorical variables in a multi-dimensional table.</li>
<li>McNemar’s test: used to determine if the difference between paired nominal data is significant.</li>
<li>Likelihood-ratio test: used to compare nested models, where the more complex model is tested against a simpler model.</li>
<li>Mantel-Haenszel test: used to determine if there is a relationship between two categorical variables while controlling for the effect of a third variable.</li>
</ul>
</section>
<section id="chi-square-goodness-of-fit-test" class="level2">
<h2 class="anchored" data-anchor-id="chi-square-goodness-of-fit-test">Chi-Square Goodness of Fit test</h2>
<section id="a-business-application-of-the-chi-square-goodness-of-fit-test" class="level3">
<h3 class="anchored" data-anchor-id="a-business-application-of-the-chi-square-goodness-of-fit-test">A Business Application of the Chi-Square Goodness of Fit test</h3>
<ol type="1">
<li>Suppose a <strong>retail</strong> company wants to know <strong>if the gender distribution of their customer base is representative of the general population</strong>. They collect data on the gender of a sample of their customers and compare it to the expected distribution (e.g.&nbsp;50% male and 50% female).</li>
<li>The Chi-Square Goodness of Fit test is then used to evaluate the <strong>null hypothesis</strong> that the observed distribution of gender among the company’s customers is the same as the expected distribution.</li>
<li>The test could help us potentially conclude that there is a significant difference between the observed and expected distributions, and the company’s customer base may not be representative of the general population.</li>
<li>For example, <strong>the results might show that a significantly higher proportion of females than expected are customers of the company</strong>. This information could be used by the retail company to tailor their marketing strategies and product offerings to better attract male customers.</li>
</ol>
</section>
<section id="concept" class="level3">
<h3 class="anchored" data-anchor-id="concept">Concept</h3>
<p>The Chi-Square Goodness-of-Fit test is a statistical tool used to determine if the observed data in a categorical dataset aligns with the expected data based on a particular hypothesis or anticipated distribution. It helps researchers evaluate if there exists a noteworthy difference between the actual data and what would be anticipated under a specific theoretical model or hypothesis.</p>
<p>Here are the essential steps and concepts involved in carrying out a Chi-Square Goodness-of-Fit test:</p>
<ol type="1">
<li>Hypotheses:
<ul>
<li>Null Hypothesis (H0): The observed data conforms to a specific theoretical distribution.</li>
<li>Alternative Hypothesis (Ha): The observed data does not conform to the specified theoretical distribution.</li>
</ul></li>
<li>Categorical Data:
<ul>
<li>The data should be categorical, divided into distinct categories or groups.</li>
<li>We need both observed (actual) and expected frequencies for each category.</li>
</ul></li>
<li>Expected Frequencies:
<ul>
<li>Calculate the expected frequencies for each category based on the null hypothesis or the theoretical distribution. These expected values represent what we would anticipate seeing if the null hypothesis were accurate.</li>
<li>Expected frequencies can be computed using a formula or by multiplying the total sample size by the probabilities associated with each category according to the theoretical distribution.</li>
</ul></li>
<li>Chi-Square Statistic:
<ul>
<li><p>Determine the Chi-Square statistic using this formula:</p>
<p>χ² = Σ ((O - E)² / E)</p>
<ul>
<li>χ²: Chi-Square statistic</li>
<li>O: Observed frequency for a category</li>
<li>E: Expected frequency for the same category</li>
<li>Σ: The sum symbol, signifying that we should perform this calculation for all categories</li>
</ul></li>
</ul></li>
<li>Degrees of Freedom (df):
<ul>
<li>The degrees of freedom for a Chi-Square Goodness-of-Fit test is equal to the number of categories minus one, or df = (number of categories - 1).</li>
</ul></li>
<li>Chi-Square Distribution:
<ul>
<li>The Chi-Square statistic follows a specific distribution known as the Chi-Square distribution, with df degrees of freedom.</li>
</ul></li>
<li>Critical Value and Significance Level:
<ul>
<li>Identify the critical value for the Chi-Square test at a chosen significance level (usually denoted as alpha). The critical value is typically derived from a Chi-Square distribution table or statistical software.</li>
<li>Common significance levels include 0.05 or 0.01.</li>
</ul></li>
<li>Statistic vs.&nbsp;Critical Value Comparison:
<ul>
<li>If the calculated Chi-Square statistic exceeds the critical value, we reject the null hypothesis.</li>
<li>If the calculated Chi-Square statistic is less than or equal to the critical value, we do not reject the null hypothesis.</li>
</ul></li>
<li>Interpretation:
<ul>
<li>Rejecting the null hypothesis implies a significant discrepancy between the observed data and the expected distribution, suggesting that the data does not adhere to the specified theoretical model.</li>
<li>Failing to reject the null hypothesis suggests no significant difference, indicating that the observed data aligns with the expected distribution.</li>
</ul></li>
</ol>
<p>In summary, the Chi-Square Goodness-of-Fit test serves to evaluate whether categorical data conforms to a particular theoretical distribution. It helps us assess whether any deviations from the expected distribution are statistically meaningful or simply due to chance.</p>
</section>
<section id="numerical-illustration" class="level3">
<h3 class="anchored" data-anchor-id="numerical-illustration">Numerical Illustration</h3>
<p><strong>Business Scenario</strong></p>
<p>We work for an e-commerce company that sells electronic gadgets, and we want to determine whether the distribution of the company’s most popular product categories among customers follows the expected distribution based on market research conducted last year. The expected distribution from the research is as follows:</p>
<ul>
<li>Smartphones: 30%</li>
<li>Laptops: 40%</li>
<li>Accessories: 20%</li>
<li>Wearables: 10%</li>
</ul>
<p>We want to test whether the observed distribution of product categories sold in a recent month matches the expected distribution.</p>
<p><strong>Simulated Observed Data</strong></p>
<p>In the recent month, we collected sales data, and we found the following distribution of product categories sold:</p>
<ul>
<li>Smartphones: 25</li>
<li>Laptops: 42</li>
<li>Accessories: 18</li>
<li>Wearables: 15</li>
</ul>
<p><strong>Chi-Square Goodness-of-Fit Test</strong></p>
<p><em>Step 1: Set up Hypotheses</em></p>
<ul>
<li>Null Hypothesis (H0): The observed distribution matches the expected distribution.</li>
<li>Alternative Hypothesis (Ha): The observed distribution does not match the expected distribution.</li>
</ul>
<p><em>Step 2: Organize Data</em></p>
<ul>
<li>Expected Distribution:
<ul>
<li>Smartphones: 30%</li>
<li>Laptops: 40%</li>
<li>Accessories: 20%</li>
<li>Wearables: 10%</li>
</ul></li>
<li>Observed Distribution:
<ul>
<li>Smartphones: 25</li>
<li>Laptops: 42</li>
<li>Accessories: 18</li>
<li>Wearables: 15</li>
</ul></li>
</ul>
<p><em>Step 3: Calculate Expected Frequencies</em></p>
<ul>
<li>Calculate the expected frequencies by applying the expected percentages to the total number of products sold:
<ul>
<li>Expected Smartphones: 105 (total * 30%)</li>
<li>Expected Laptops: 140 (total * 40%)</li>
<li>Expected Accessories: 70 (total * 20%)</li>
<li>Expected Wearables: 35 (total * 10%)</li>
</ul></li>
</ul>
<p><em>Step 4: Calculate the Chi-Square Statistic</em></p>
<ul>
<li>Use the formula: χ² = Σ ((O - E)² / E) for each category and then sum them up.</li>
<li>χ² = [(25 - 105)² / 105] + [(42 - 140)² / 140] + [(18 - 70)² / 70] + [(15 - 35)² / 35]</li>
<li>χ² = (6560 / 105) + (6560 / 140) + (3132 / 70) + (400 / 35)</li>
<li>χ² ≈ 62.48 (rounded to two decimal places)</li>
</ul>
<p><em>Step 5: Determine Degrees of Freedom (df)</em></p>
<ul>
<li>df = (Number of Categories - 1) = 4 - 1 = 3</li>
</ul>
<p><em>Step 6: Set Significance Level</em></p>
<ul>
<li>Choose a significance level (alpha), e.g., 0.05.</li>
</ul>
<p><em>Step 7: Find Critical Value</em></p>
<ul>
<li>Using a Chi-Square distribution table or calculator for df = 3 and α = 0.05, the critical value is approximately 7.815.</li>
</ul>
<p><em>Step 8: Compare Statistic to Critical Value</em></p>
<ul>
<li>χ² (calculated) ≈ 62.48 &gt; χ² (critical) ≈ 7.815</li>
</ul>
<p><em>Step 9: Make a Decision</em></p>
<ul>
<li>Since the calculated Chi-Square statistic (62.48) is greater than the critical value (7.815), we reject the null hypothesis.</li>
</ul>
<p><em>Step 10: Interpretation</em></p>
<ul>
<li>We conclude that there is a significant difference between the observed distribution of product categories sold and the expected distribution based on market research. In other words, the product categories sold do not match the expected distribution.</li>
</ul>
</section>
<section id="running-the-chi-square-goodness-of-fit-test-in-r" class="level3">
<h3 class="anchored" data-anchor-id="running-the-chi-square-goodness-of-fit-test-in-r">Running the Chi-Square Goodness of Fit Test in R</h3>
<p><strong>1. Data Preparation</strong></p>
<p>We start with the <code>mtcars</code> dataset, which contains information about 32 cars, each categorized with 3, 4, or 5 gears.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the mtcars dataset</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a table to count the number of cars in each gear category</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>gear_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(mtcars<span class="sc">$</span>gear)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>gear_counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 3  4  5 
15 12  5 </code></pre>
</div>
</div>
<p><strong>2. Visualization of Contingency Table</strong></p>
<p>We visualize the contingency table using a graphical balloon plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the gplots library for graphical plotting</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"gplots"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gplots'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    lowess</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert gear counts into a table format</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>gear_table <span class="ot">&lt;-</span> <span class="fu">as.table</span>(<span class="fu">as.matrix</span>(gear_counts))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a graphical balloon plot</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">balloonplot</span>(<span class="fu">t</span>(gear_table), <span class="at">main=</span><span class="st">"Contingency Table"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab=</span><span class="st">"Gear"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">label=</span><span class="cn">FALSE</span>, <span class="at">show.margins=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03ChiSquareTests_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p><strong>3. Calculation of Proportions</strong></p>
<p>We calculate the proportions of cars in each gear category:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate proportions of cars in each gear category</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>gear_proportions <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(gear_counts)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>gear_proportions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      3       4       5 
0.46875 0.37500 0.15625 </code></pre>
</div>
</div>
<p><strong>4. Running the Chi-Square Goodness-of-Fit Test</strong></p>
<p>We specify the expected probabilities for each gear category and perform the chi-square goodness-of-fit test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the expected probabilities for each gear category</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>expected_probs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the chi-square goodness-of-fit test using observed proportions and expected probabilities</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>chisq_test_result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(gear_proportions, <span class="at">p=</span>expected_probs)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>chisq_test_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  gear_proportions
X-squared = 0.030273, df = 2, p-value = 0.985</code></pre>
</div>
</div>
<p><strong>5. Interpretation</strong></p>
<p>After running the chi-square goodness-of-fit test using the provided expected probabilities, the output provides important information:</p>
<ul>
<li><p><strong>Chi-squared test for given probabilities</strong>: This line indicates that the test conducted is specifically a chi-square goodness-of-fit test. It’s designed to assess whether the observed data fits the expected probabilities we’ve provided.</p></li>
<li><p><strong>data: gear_proportions</strong>: This line specifies the dataset used for the test, which is the <code>gear_proportions</code> dataset. This dataset contains the observed proportions of cars in different gear categories.</p></li>
<li><p><strong>X-squared = 0.030273</strong>: This value represents the chi-square statistic (X²), which is a measure of how closely the observed proportions align with the expected probabilities. In this case, the calculated chi-square statistic is approximately 0.030273.</p></li>
<li><p><strong>df = 2</strong>: This indicates the degrees of freedom (df) associated with the chi-square distribution. In a goodness-of-fit test like this one, the df is calculated as one less than the number of categories being analyzed. Here, since there are three gear categories (3, 4, and 5), df equals 2.</p></li>
<li><p><strong>p-value = 0.985</strong>: The p-value is a crucial result of the test. It represents the probability of observing a chi-square statistic as extreme as the calculated value (0.030273) under the assumption that there is no significant difference between the observed and expected proportions. In this case, the high p-value of 0.985 suggests that the observed data aligns well with the expected probabilities. A high p-value implies that there is no strong evidence to reject the null hypothesis, which means that the data does not provide significant grounds to believe that the observed proportions are different from what was expected.</p></li>
</ul>
<p>In summary, this output tells us that the chi-square goodness-of-fit test was conducted using the observed proportions of cars in different gear categories and the specified expected probabilities. The resulting high p-value (0.985) indicates that there is no strong reason to conclude that the observed proportions significantly differ from the expected probabilities, thus failing to reject the null hypothesis.</p>
</section>
<section id="comparison-of-chi-square-goodness-of-fit-test-with-z-test-for-proportions" class="level3">
<h3 class="anchored" data-anchor-id="comparison-of-chi-square-goodness-of-fit-test-with-z-test-for-proportions">Comparison of Chi-Square Goodness of Fit test with Z-test for Proportions</h3>
<p>Certainly, here’s a concise comparison of the Chi-Square Goodness of Fit test and the Z-test for Proportions:</p>
<p>The Chi-Square Goodness of Fit test is employed to assess whether observed data conforms to an expected distribution, particularly when dealing with categorical data. It evaluates the similarity between observed and expected frequencies across different categories, typically through a chi-square statistic and follows a chi-square distribution.</p>
<p>The Chi-Square Goodness of Fit test is used when you have categories or groups, and it helps determine if the observed data matches an expected distribution within those categories. It’s like checking if things are divided as you’d expect.</p>
<p>In contrast, the Z-test for Proportions focuses on comparing a sample proportion with a known population proportion, typically in binary data scenarios. It uses a Z-score to measure the difference and follows a standard normal distribution.</p>
<p>The Z-test helps you assess if the proportion of “yes” responses in your sample significantly differs from a known or expected proportion. It’s like comparing one group to a known standard.</p>
</section>
</section>
<section id="chi-square-test-of-independence" class="level2">
<h2 class="anchored" data-anchor-id="chi-square-test-of-independence">Chi-Square Test of Independence</h2>
<section id="a-business-application-of-the-chi-square-test-of-independence" class="level3">
<h3 class="anchored" data-anchor-id="a-business-application-of-the-chi-square-test-of-independence">A Business Application of the Chi-Square Test of Independence</h3>
<ol type="1">
<li>Suppose a grocery store wants to evaluate the <strong>association</strong> between the <strong>type of product</strong> a customer buys and their <strong>age group</strong>.</li>
<li>Suppose the grocery store wants to know if there is a significant association between the <strong>type of product a customer buys</strong> (<strong>e.g.&nbsp;fruits, vegetables, or dairy products</strong>) and their <strong>age group</strong> (e.g.&nbsp;<strong>18-30, 31-45, 46-60, 61 and older</strong>). They collect data on the age group and product type for a sample of customers and create a contingency table.</li>
<li>The Chi-square test is then used to evaluate the <strong>null hypothesis</strong> that the <strong>product type and age group are independent</strong>.</li>
<li>Depending on the test result, we could potentially conclude that there is a significant association between the two variables.</li>
<li>For example, the results might show that <strong>a significantly higher proportion of customers in the 46-60 age group buy fruits compared to the other age groups</strong>.</li>
<li>This information could be used by the grocery store to adjust their marketing strategies and product offerings to better cater to their target customers.</li>
</ol>
</section>
<section id="chi-square-test-of-independence-technicalities" class="level3">
<h3 class="anchored" data-anchor-id="chi-square-test-of-independence-technicalities">Chi-Square Test of Independence – Technicalities</h3>
<ol type="1">
<li>The Chi-square test of independence is a statistical test used to determine if there is a significant association between two categorical variables.</li>
<li>The test evaluates the <strong>null hypothesis</strong> that the <strong>two variables are independent</strong> and <strong>calculates a test statistic (chi-square)</strong> based on the difference between the observed and expected frequencies of the two variables.</li>
<li>If the calculated test statistic is larger than the <strong>critical value from a chi-square distribution table</strong>, then the null hypothesis is rejected and it can be concluded that there is a significant association between the two variables.</li>
</ol>
</section>
<section id="running-the-chi-square-test-of-independence-test-in-r" class="level3">
<h3 class="anchored" data-anchor-id="running-the-chi-square-test-of-independence-test-in-r">Running the Chi-Square Test of Independence Test in R</h3>
<ol type="1">
<li>Convert the categorical variables into factor variables in the dataset mtcars</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mtcars<span class="sc">$</span>cyl)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>am  <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mtcars<span class="sc">$</span>am)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>gear  <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mtcars<span class="sc">$</span>gear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Creating a Contingency Table:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ctab <span class="ot">&lt;-</span> <span class="fu">table</span>(mtcars<span class="sc">$</span>am, mtcars<span class="sc">$</span>cyl)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ctab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
     4  6  8
  0  3  4 12
  1  8  3  2</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Graphical display of Contingency table:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"gplots"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. convert the data as a table</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">as.table</span>(<span class="fu">as.matrix</span>(ctab))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Graph</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">balloonplot</span>(<span class="fu">t</span>(dt), <span class="at">main =</span><span class="st">"Contingency Table"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab =</span><span class="st">"cyl"</span>, <span class="at">ylab=</span><span class="st">"am"</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="cn">FALSE</span>, <span class="at">show.margins =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03ChiSquareTests_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<ol start="4" type="1">
<li>Compute Chi-Square test: The Chi-square statistic can be easily computed using the function <code>chisq.test()</code> as follow:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>chisq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(ctab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(ctab): Chi-squared approximation may be incorrect</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>chisq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  ctab
X-squared = 8.7407, df = 2, p-value = 0.01265</code></pre>
</div>
</div>
<ol start="5" type="1">
<li><p>In our example, the row and the column variables are statistically significantly associated (p-value = 0.01265).</p></li>
<li><p>The observed and the expected counts can be extracted from the result of the test as follows:</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observed counts</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>chisq<span class="sc">$</span>observed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
     4  6  8
  0  3  4 12
  1  8  3  2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected counts</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(chisq<span class="sc">$</span>expected, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
       4    6    8
  0 6.53 4.16 8.31
  1 4.47 2.84 5.69</code></pre>
</div>
</div>
<ol start="7" type="1">
<li>Pearson Residuals: <strong>Positive residuals</strong> are positive values in cells specify an attraction (positive association) between the corresponding row and column variables. <strong>Negative residuals</strong> implies a repulsion (negative association) between the corresponding row and column variables.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(chisq<span class="sc">$</span>residuals, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
         4      6      8
  0 -1.382 -0.077  1.279
  1  1.670  0.093 -1.546</code></pre>
</div>
</div>
<p>##References</p>
<p>[1] Agresti, A. (2002). Categorical data analysis (2nd ed.). Wiley.</p>
<p>Hair Jr, J. F., Black, W. C., Babin, B. J., &amp; Anderson, R. E. (2010). Multivariate data analysis: A global perspective (7th ed.). Pearson Education.</p>
<p>Everitt, B. S. (1992). The analysis of contingency tables (2nd ed.). Chapman and Hall.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://www.qatar.cmu.edu/directory/sameer-mathur/">Sameer Mathur</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://docs.google.com/document/d/15Li_DpXPSA6NXyXyCzM3vUu766RBq87W/edit?usp=sharing&amp;ouid=100224206438187222136&amp;rtpof=true&amp;sd=true">Aryeman Gupta Mathur</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>